---
// BrandedFloatingBanner.css-only.astro
// Pure CSS toggle (no JS persistence). Hidden checkbox toggles expanded/minimized states.
// Props:
//  - brandName (string)
//  - logoSrc (string | null)
//  - tagline (string | null)
//  - cta ({ label, href } | null)
//  - position: 'bottom-right' | 'bottom-left' (default 'bottom-right')
//  - bgColorClass, textColorClass (Tailwind utility classes — optional)
const {
  brandName = 'Your Brand',
  logoSrc = null,
  tagline = '',
  cta = null,
  position = 'bottom-right',
  bgColorClass = 'bg-white',
  textColorClass = 'text-slate-900',
} = Astro.props;
---
<style>
  /* Minimal CSS needed for the checkbox toggle pattern and small layout fallbacks.
     If you use Tailwind, most layout is controlled by its classes; these rules are only
     for the checkbox behavior and a small accessible hit area. */

  /* Hide the native checkbox but keep it keyboard-focusable for accessibility */
  .bfb-checkbox {
    position: absolute;
    opacity: 0;
    pointer-events: all;
    width: 1px;
    height: 1px;
    margin: 0;
    padding: 0;
    clip: rect(0 0 0 0);
    white-space: nowrap;
    border: 0;
  }

  /* The checkbox controls visibility of .bfb-body and .bfb-mini via sibling selector */
  .bfb-checkbox:checked ~ .bfb-box .bfb-body {
    display: none;
  }
  .bfb-checkbox:checked ~ .bfb-box .bfb-mini {
    display: block;
  }

  /* default mini hidden */
  .bfb-mini { display: none; }

  /* Make the visual toggle button have a large hit area without JS — it is a label for the checkbox */
  .bfb-toggle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: transparent;
    border: 0;
  }

  /* Small responsive adjustments if you don't have Tailwind */
  @media (max-width: 420px) {
    .bfb-container { right: 12px; left: auto; max-width: 92%; }
  }
</style>

<div
  class={`bfb-container fixed z-[9999] bottom-6 ${position === 'bottom-left' ? 'left-4 md:left-8' : 'right-4 md:right-8'} max-w-[320px] md:max-w-sm`}
  role="region"
  aria-label={`${brandName} branding`}
>
  <!-- label+checkbox pattern: label surrounds the whole thing so the toggle area is accessible -->
  <label class="relative block" style="cursor: default;">
    <!-- checkbox that controls the visual state -->
    <input class="bfb-checkbox sr-only" type="checkbox" aria-hidden="true" />

    <div class="bfb-box shadow-2xl rounded-2xl overflow-hidden transform transition-all duration-300 ring-2 ring-slate-200">
      <div class={`flex items-center gap-3 p-3 ${bgColorClass} ${textColorClass}`}>
        <!-- Logo -->
        {logoSrc && (
          <img src={logoSrc} alt={`${brandName} logo`} class="w-10 h-10 object-contain rounded-md flex-shrink-0" />
        )}

        <div class="flex-1 min-w-0">
          <div class="flex items-center gap-2">
            <h3 class="font-semibold truncate" title={brandName}>{brandName}</h3>

            <!-- Visual toggle: clicking this label child will toggle the checkbox (since checkbox is a sibling in DOM order).
                 We keep it as a <button> purely for semantics/visual but it's not required for the checkbox to work.
                 Using pointer-events on this button is safe because the checkbox is focusable via keyboard (sr-only). -->
            <span class="ml-auto">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 bfb-toggle" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
              </svg>
            </span>
          </div>

          <!-- Expanded body (visible by default) -->
          <div class="bfb-body mt-1 text-sm leading-snug opacity-90">
            {tagline && <p class="truncate" title={tagline}>{tagline}</p>}

            {cta && (
              <p class="mt-2">
                <a href={cta.href} class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium shadow-sm ring-1 ring-inset" aria-label={cta.label}>
                  {cta.label}
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden>
                    <path fill-rule="evenodd" d="M12.293 3.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-8 8a1 1 0 01-1.414-1.414L15.586 8H6a1 1 0 110-2h9.586l-3.293-3.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                  </svg>
                </a>
              </p>
            )}
          </div>

          <!-- Mini bar shown when checkbox is checked -->
          <div class="bfb-mini w-full p-2 text-xs text-center">
            <span>Branding minimized</span>
          </div>
        </div>
      </div>
    </div>
  </label>
</div>
